{"changed":true,"filter":false,"title":"loader.js","tooltip":"/Backend/webbook/loader.js","value":"const app = require('./server');\nconst router = require('./routes/main.route');\nconst cookieParser = require('cookie-parser');\nconst passport = require('passport');\nconst session = require('express-session');\nconst expressSanitizer = require('express-sanitizer');\nconst bodyParser = require('body-parser');\nconst expressValidator = require('express-validator');\nconst models=require(\"./models/\");\n\n\n//garantir que as variáveis definidas são utilizadas\n//app.use(bodyParser.json(), bodyParser.urlencoded({extended: true}));\napp.use(expressSanitizer());\napp.use(cookieParser());\napp.set('trust proxy',1);\napp.use(session({\n    secret: 'fire',\n    resave: false,\n    saveUninitialized: true,\n    cookie: {\n        secure: true,\n        maxAge: 60000,\n        httpOnly: true,\n    }\n}))\napp.use(expressValidator());\n\n//para conseguir utilizar a sessão, verificar se foi criada com sucesso\napp.use(function(req, res, next) {\n    if(global.sessData === undefined) {\n        global.sessData = req.session;\n        global.sessData.ID = req.sessionID;\n    }\n    else {\n        console.log('session exists', global.sessData.ID);\n    }\n    next();\n});\n\n//inicializar passport de forma a dar para fazer login\napp.use(passport.initialize());\napp.use(passport.session()); // persistent login sessions\nrequire('./routes/auth.js')(app, passport);\nrequire('./config/passport/passport.js')(passport, models.user);\n//Sync Database\nmodels.sequelize.sync().then(function() {\n  console.log('Nice! Database looks fine');\n\n}).catch(function(err) {\n  console.log(err, \"Something went wrong with the Database Update!\");\n});\n\n\n\napp.use('/', router);\nmodule.exports = app;\n","undoManager":{"mark":9,"position":10,"stack":[[{"start":{"row":43,"column":27},"end":{"row":43,"column":28},"action":"remove","lines":["e"],"id":2},{"start":{"row":43,"column":26},"end":{"row":43,"column":27},"action":"remove","lines":["t"]},{"start":{"row":43,"column":25},"end":{"row":43,"column":26},"action":"remove","lines":["u"]},{"start":{"row":43,"column":24},"end":{"row":43,"column":25},"action":"remove","lines":["o"]},{"start":{"row":43,"column":23},"end":{"row":43,"column":24},"action":"remove","lines":["r"]},{"start":{"row":43,"column":22},"end":{"row":43,"column":23},"action":"remove","lines":["."]}],[{"start":{"row":15,"column":22},"end":{"row":15,"column":23},"action":"remove","lines":["1"],"id":3}],[{"start":{"row":15,"column":22},"end":{"row":15,"column":23},"action":"insert","lines":["t"],"id":4},{"start":{"row":15,"column":23},"end":{"row":15,"column":24},"action":"insert","lines":["r"]},{"start":{"row":15,"column":24},"end":{"row":15,"column":25},"action":"insert","lines":["u"]},{"start":{"row":15,"column":25},"end":{"row":15,"column":26},"action":"insert","lines":["e"]}],[{"start":{"row":15,"column":25},"end":{"row":15,"column":26},"action":"remove","lines":["e"],"id":5},{"start":{"row":15,"column":24},"end":{"row":15,"column":25},"action":"remove","lines":["u"]},{"start":{"row":15,"column":23},"end":{"row":15,"column":24},"action":"remove","lines":["r"]},{"start":{"row":15,"column":22},"end":{"row":15,"column":23},"action":"remove","lines":["t"]}],[{"start":{"row":15,"column":22},"end":{"row":15,"column":23},"action":"insert","lines":["1"],"id":6}],[{"start":{"row":55,"column":9},"end":{"row":55,"column":10},"action":"remove","lines":["/"],"id":7}],[{"start":{"row":55,"column":9},"end":{"row":55,"column":10},"action":"insert","lines":["/"],"id":8}],[{"start":{"row":1,"column":43},"end":{"row":1,"column":44},"action":"insert","lines":["."],"id":9},{"start":{"row":1,"column":44},"end":{"row":1,"column":45},"action":"insert","lines":["j"]}],[{"start":{"row":1,"column":45},"end":{"row":1,"column":46},"action":"insert","lines":["s"],"id":10}],[{"start":{"row":1,"column":45},"end":{"row":1,"column":46},"action":"remove","lines":["s"],"id":11},{"start":{"row":1,"column":44},"end":{"row":1,"column":45},"action":"remove","lines":["j"]},{"start":{"row":1,"column":43},"end":{"row":1,"column":44},"action":"remove","lines":["."]}],[{"start":{"row":12,"column":0},"end":{"row":12,"column":1},"action":"insert","lines":["/"],"id":12},{"start":{"row":12,"column":1},"end":{"row":12,"column":2},"action":"insert","lines":["/"]}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":12,"column":2},"end":{"row":12,"column":2},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":6,"state":"start","mode":"ace/mode/javascript"}},"timestamp":1610981868315}